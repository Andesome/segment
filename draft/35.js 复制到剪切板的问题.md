# 35.js 复制到剪切板的问题
## <a name="index"></a> 目录
- [场景](#situation)
- [问题1](#style)
  - [问题12](#link)
- [参考资料](#reference)


## <a name="situation"></a> 场景
前不久碰到了一个复制到剪切板失效的 bug，这个功能是使用了第三方插件[jquery-zclip][url-github-zclip]实现。最后排查出来的原因，让我个人产生了很深刻的记忆，在此记录，以作纪念。

## js 复制到剪切板的问题
刚开始报错很明显，很快排查出原因是全局变量冲突。百度富文本编辑器实现复制到剪切板的功能，使用第三插件 [zeroclipboard][url-github-zeroclipboard]，为此功能声明了全局变量：`ZeroClipboard`，跟插件 `jquery-zclip` 中全局变量名称一致。但是很奇怪，为什么一个插件要向外暴露一个全局变量，没有多想，觉得把 `jquery-zclip` 中全局声明放到插件内部应该就可以了。

把声明的全局变量放进去之后，没有效果，打断点发现主要对象，都没有初始化，好奇怪，对于调用的地方来说，按照作用域链也是可以访问到的，为什么没有初始化？由于时间有限，既然名称相同，这个好说，换个名称就可以了。


于是选择了实现较简单的 `jquery-zclip` 进行修改名称。替换也不多，很快就换好了。验证的时候，发现还是没有效果，于是就检查是不是漏了什么地方，重新排查了一篇确定遗漏。然后打断点，发现也正常初始化了，那么就猜测初始化的对象是不是有问题，于是接下来准备两套代码，对比修改前后初始化的差异。

果然初始化后，修改了名称后对象少了一个属性，没办法了，只有详细去看里面的逻辑了

## <a name="reference"></a> 参考资料
[wiki Regular Expression](https://en.wikipedia.org/wiki/Regular_expression)


[url-github-zclip]:https://github.com/patricklodder/jquery-zclip
[url-github-zeroclipboard]:https://github.com/zeroclipboard/zeroclipboard